{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, inject, onMounted, watch, computed } from 'vue';\nimport { useRoute } from 'vue-router';\nimport { useRouter } from 'vue-router';\nimport axios from 'axios';\nimport qs from 'qs';\nimport Footer from '../components/Footer.vue';\nexport default {\n  name: 'UserAddress',\n  components: {\n    Footer\n  },\n  setup() {\n    const route = useRoute();\n    const router = useRouter();\n    const businessId = ref(route.query.businessId);\n    const user = ref({});\n    const deliveryAddressArr = ref([]);\n    onMounted(() => {\n      // console.log(businessId.value);\n      user.value = JSON.parse(sessionStorage.getItem('user'));\n      listDeliveryAddressByUserId();\n    });\n    const contactSex = index => {\n      return deliveryAddressArr.value[index].contactSex === 1 ? '先生' : '女士';\n    };\n\n    // 请求所有地址信息\n    const listDeliveryAddressByUserId = () => {\n      axios.post('DeliveryAddressController/listDeliveryAddressByUserId', qs.stringify({\n        userId: user.value.userId\n      })).then(response => {\n        deliveryAddressArr.value = response.data;\n        // console.log('地址信息:', deliveryAddressArr.value);\n      }).catch(error => {\n        console.error(error);\n      });\n    };\n\n    // 把选择地址放入localStorage\n    const setDeliveryAddress = deliveryAddress => {\n      localStorage.setItem(user.value.userId, JSON.stringify(deliveryAddress));\n      router.push({\n        path: '/orders',\n        query: {\n          businessId: businessId.value\n        }\n      });\n    };\n    const toAddUserAddress = () => {\n      router.push({\n        path: '/addUserAddress',\n        query: {\n          businessId: businessId.value\n        }\n      });\n    };\n    const editUserAddress = daId => {\n      router.push({\n        path: '/editUserAddress',\n        query: {\n          businessId: businessId.value\n        }\n      });\n      // 把地址号放入sessionStorage\n      sessionStorage.setItem('daId', daId);\n    };\n    const removeUserAddress = daId => {\n      if (!confirm('确认要删除此送货地址吗?')) {\n        return;\n      }\n      // 删除地址请求\n      axios.post('DeliveryAddressController/removeDeliveryAddress', qs.stringify({\n        daId: daId\n      })).then(response => {\n        if (response.data > 0) {\n          if (JSON.parse(localStorage.getItem(user.value.userId)).daId == daId) {\n            localStorage.removeItem(user.value.userId);\n          }\n          listDeliveryAddressByUserId();\n        } else {\n          alert('删除地址失败!');\n        }\n      }).catch(error => {\n        console.error(error);\n      });\n    };\n    return {\n      businessId,\n      user,\n      deliveryAddressArr,\n      contactSex,\n      listDeliveryAddressByUserId,\n      setDeliveryAddress,\n      toAddUserAddress,\n      editUserAddress,\n      removeUserAddress\n    };\n  }\n};","map":{"version":3,"names":["ref","inject","onMounted","watch","computed","useRoute","useRouter","axios","qs","Footer","name","components","setup","route","router","businessId","query","user","deliveryAddressArr","value","JSON","parse","sessionStorage","getItem","listDeliveryAddressByUserId","contactSex","index","post","stringify","userId","then","response","data","catch","error","console","setDeliveryAddress","deliveryAddress","localStorage","setItem","push","path","toAddUserAddress","editUserAddress","daId","removeUserAddress","confirm","removeItem","alert"],"sources":["F:\\elmprogram\\elm\\elmclient\\src\\views\\UserAddress.vue"],"sourcesContent":["<template>\r\n\t<div class=\"wrapper\">\r\n\t\t<!-- header -->\r\n\t\t<header>\r\n\t\t\t<p>地址管理</p>\r\n\t\t</header>\r\n\r\n\t\t<!-- 地址列表 -->\r\n\t\t<ul class=\"address\">\r\n\t\t\t<li v-for=\"(item,index) in deliveryAddressArr\" :key=\"item.id\">\r\n\t\t\t\t<div class=\"address-info\" @click=\"setDeliveryAddress(item)\">\r\n\t\t\t\t\t<div class=\"address-info-detailed\">\r\n\t\t\t\t\t\t<p>{{ item.contactName }}{{ contactSex(index) }}</p>\r\n\t\t\t\t\t\t<p>{{ item.contactTel }}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<p>{{ item.address }}</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"address-icon\">\r\n\t\t\t\t\t<i class=\"fa fa-edit\" @click=\"editUserAddress(item.daId)\"></i>\r\n\t\t\t\t\t<i class=\"fa fa-remove\" @click=\"removeUserAddress(item.daId)\"></i>\r\n\t\t\t\t</div>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\r\n\t\t<!-- 新增地址 -->\r\n\t\t<div class=\"address-new\" @click=\"toAddUserAddress\">\r\n\t\t\t<i class=\"fa fa-plus-circle\"></i>\r\n\t\t\t<p>新增收货地址</p>\r\n\t\t</div>\r\n\r\n\t\t<!-- 底部菜单部分 -->\r\n\t\t<Footer></Footer>\r\n\r\n\t</div>\r\n\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tref,\r\n\t\tinject,\r\n\t\tonMounted,\r\n\t\twatch,\r\n\t\tcomputed\r\n\t} from 'vue';\r\n\timport {\r\n\t\tuseRoute\r\n\t} from 'vue-router';\r\n\timport {\r\n\t\tuseRouter\r\n\t} from 'vue-router';\r\n\timport axios from 'axios';\r\n\timport qs from 'qs';\r\n\timport Footer from '../components/Footer.vue';\r\n\r\n\texport default {\r\n\t\tname: 'UserAddress',\r\n\t\tcomponents: {\r\n\t\t\tFooter\r\n\t\t},\r\n\t\tsetup() {\r\n\t\t\tconst route = useRoute();\r\n\t\t\tconst router = useRouter();\r\n\t\t\tconst businessId = ref(route.query.businessId);\r\n\t\t\tconst user = ref({});\r\n\t\t\tconst deliveryAddressArr = ref([])\r\n\r\n\t\t\tonMounted(() => {\r\n\t\t\t\t// console.log(businessId.value);\r\n\t\t\t\tuser.value = JSON.parse(sessionStorage.getItem('user'));\r\n\t\t\t\tlistDeliveryAddressByUserId();\r\n\t\t\t});\r\n\r\n\t\t\tconst contactSex = (index) => {\r\n\t\t\t\treturn deliveryAddressArr.value[index].contactSex === 1 ? '先生' : '女士';\r\n\t\t\t};\r\n\r\n\t\t\t// 请求所有地址信息\r\n\t\t\tconst listDeliveryAddressByUserId = () => {\r\n\t\t\t\taxios.post('DeliveryAddressController/listDeliveryAddressByUserId', qs.stringify({\r\n\t\t\t\t\tuserId: user.value.userId\r\n\t\t\t\t})).then(response => {\r\n\t\t\t\t\tdeliveryAddressArr.value = response.data;\r\n\t\t\t\t\t// console.log('地址信息:', deliveryAddressArr.value);\r\n\t\t\t\t}).catch(error => {\r\n\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t// 把选择地址放入localStorage\r\n\t\t\tconst setDeliveryAddress = (deliveryAddress) => {\r\n\t\t\t\tlocalStorage.setItem(user.value.userId, JSON.stringify(deliveryAddress));\r\n\t\t\t\trouter.push({\r\n\t\t\t\t\tpath: '/orders',\r\n\t\t\t\t\tquery: {\r\n\t\t\t\t\t\tbusinessId: businessId.value\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tconst toAddUserAddress = () => {\r\n\t\t\t\trouter.push({\r\n\t\t\t\t\tpath: '/addUserAddress',\r\n\t\t\t\t\tquery: {\r\n\t\t\t\t\t\tbusinessId: businessId.value\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tconst editUserAddress = (daId) => {\r\n\t\t\t\trouter.push({\r\n\t\t\t\t\tpath: '/editUserAddress',\r\n\t\t\t\t\tquery: {\r\n\t\t\t\t\t\tbusinessId: businessId.value\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\t// 把地址号放入sessionStorage\r\n\t\t\t\tsessionStorage.setItem('daId', daId);\r\n\t\t\t};\r\n\r\n\r\n\t\t\tconst removeUserAddress = (daId) => {\r\n\t\t\t\tif (!confirm('确认要删除此送货地址吗?')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t// 删除地址请求\r\n\t\t\t\taxios.post('DeliveryAddressController/removeDeliveryAddress', qs.stringify({\r\n\t\t\t\t\tdaId: daId,\r\n\t\t\t\t})).then(response => {\r\n\t\t\t\t\tif (response.data > 0) {\r\n\t\t\t\t\t\tif (JSON.parse(localStorage.getItem(user.value.userId)).daId == daId) {\r\n\t\t\t\t\t\t\tlocalStorage.removeItem(user.value.userId);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tlistDeliveryAddressByUserId();\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\talert('删除地址失败!');\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(error => {\r\n\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\r\n\t\t\treturn {\r\n\t\t\t\tbusinessId,\r\n\t\t\t\tuser,\r\n\t\t\t\tdeliveryAddressArr,\r\n\t\t\t\tcontactSex,\r\n\t\t\t\tlistDeliveryAddressByUserId,\r\n\t\t\t\tsetDeliveryAddress,\r\n\t\t\t\ttoAddUserAddress,\r\n\t\t\t\teditUserAddress,\r\n\t\t\t\tremoveUserAddress\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t/****************** 总容器 ****************/\r\n\t.wrapper {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tbackground-color: #F5F4F6;\r\n\t}\r\n\r\n\t/****************** header ****************/\r\n\t.wrapper header {\r\n\t\twidth: 100%;\r\n\t\theight: 12vw;\r\n\t\tbackground-color: #0097ff;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 4.8vw;\r\n\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\ttop: 0;\r\n\t\tz-index: 1000;\r\n\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t/****************** 地址列表 ****************/\r\n\t.wrapper .address {\r\n\t\twidth: 100%;\r\n\t\tmargin-top: 12vw;\r\n\t\tmargin-bottom: 4vw;\r\n\t}\r\n\r\n\t.wrapper .address li {\r\n\t\twidth: 100%;\r\n\t\theight: 18vw;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-bottom: solid 1px #ddd;\r\n\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.wrapper .address li .address-info {\r\n\t\twidth: 100%;\r\n\t\tmargin-left: 3vw;\r\n\t}\r\n\r\n\t.wrapper .address li .address-info .address-info-detailed {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.wrapper .address li .address-info .address-info-detailed p:first-child {\r\n\t\tfont-size: 5vw;\r\n\t\tcolor: #777;\r\n\t\tmargin-right: 2vw;\r\n\t}\r\n\r\n\t.wrapper .address li .address-info .address-info-detailed p:last-child {\r\n\t\tfont-size: 5vw;\r\n\t\tcolor: #777;\r\n\t}\r\n\r\n\t.wrapper .address li .address-info p {\r\n\t\tfont-size: 4vw;\r\n\t\tcolor: #777;\r\n\t}\r\n\r\n\t.wrapper .address li .address-icon {\r\n\t\tdisplay: flex;\r\n\t\tmargin-right: 4vw;\r\n\t}\r\n\r\n\t.wrapper .address li .address-icon i {\r\n\t\tfont-size: 5vw;\r\n\t\tcolor: #777;\r\n\t\tmargin-right: 2vw;\r\n\t}\r\n\r\n\t.wrapper .address-new {\r\n\t\twidth: 100%;\r\n\t\theight: 15vw;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-top: solid 1px #ddd;\r\n\t\tborder-bottom: solid 1px #ddd;\r\n\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.wrapper .address-new i {\r\n\t\tfont-size: 4vw;\r\n\t\tcolor: #0097ff;\r\n\t\tmargin-right: 2vw;\r\n\t}\r\n\r\n\t.wrapper .address-new p {\r\n\t\tfont-size: 4vw;\r\n\t\tcolor: #0097ff;\r\n\t}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}