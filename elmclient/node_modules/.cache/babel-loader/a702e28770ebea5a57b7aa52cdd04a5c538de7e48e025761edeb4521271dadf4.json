{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nexport default {\n  name: 'Orders',\n  data() {\n    return {\n      businessId: this.$route.query.businessId,\n      business: {},\n      user: {},\n      cartArr: [],\n      deliveryaddress: {}\n    };\n  },\n  created() {\n    this.user = this.$getSessionStorage('user');\n    this.deliveryaddress = this.$getLocalStorage(this.user.userId);\n\n    //查询当前商家\n    this.$axios.post('BusinessController/getBusinessById', this.$qs.stringify({\n      businessId: this.businessId\n    })).then(response => {\n      this.business = response.data;\n    }).catch(error => {\n      console.error(error);\n    });\n\n    //查询当前用户在购物车中的商家食品列表\n    this.$axios.post('CartController/listCart', this.$qs.stringify({\n      userId: this.user.userId,\n      businessId: this.businessId\n    })).then(response => {\n      this.cartArr = response.data;\n    }).catch(error => {\n      console.error(error);\n    });\n  },\n  methods: {\n    toUserAddress() {\n      this.$router.push({\n        path: '/userAddress',\n        query: {\n          businessId: this.businessId\n        }\n      });\n    },\n    toPayment() {\n      if (this.deliveryaddress == null) {\n        alert('请选择送货地址');\n        return;\n      }\n\n      //创建订单\n      this.$axios.post('OrderController/createOrders', this.$qs.stringify({\n        userId: this.user.userId,\n        businessId: this.businessId,\n        daId: this.deliveryaddress,\n        orderTotal: this.totalPrice\n      })).then(response => {\n        let orderId = response.data;\n        if (orderId > 0) {\n          this.$router.push({\n            path: '/payment'\n          });\n        } else {\n          alter('创建订单失败');\n        }\n      }).catch(error => {\n        console.error(error);\n      });\n    }\n  },\n  computed: {\n    totalPrice() {\n      let totalPrice = 0;\n      for (let cartItem of this.cartArr) {\n        totalPrice += cartItem.food.foodPrice * cartItem.quantity;\n      }\n      totalPrice += this.business.deliveryPrice;\n      return totalPrice;\n    },\n    userSex() {\n      return this.user.userSex === 1 ? '先生' : '女士';\n    }\n  }\n};","map":{"version":3,"names":["name","data","businessId","$route","query","business","user","cartArr","deliveryaddress","created","$getSessionStorage","$getLocalStorage","userId","$axios","post","$qs","stringify","then","response","catch","error","console","methods","toUserAddress","$router","push","path","toPayment","alert","daId","orderTotal","totalPrice","orderId","alter","computed","cartItem","food","foodPrice","quantity","deliveryPrice","userSex"],"sources":["D:\\vue\\vue3\\elm\\elmclient\\src\\views\\Orders.vue"],"sourcesContent":["<template>\r\n\t<div class=\"wrapper\">\r\n\t\t<!-- header -->\r\n\t\t<header>\r\n\t\t\t<p>确认订单</p>\r\n\t\t</header>\r\n\r\n\t\t<!-- 订单信息 -->\r\n\t\t<div class=\"order-info\">\r\n\t\t\t<h5>订单配送至:</h5>\r\n\t\t\t<div class=\"order-info-address\" @click=\"toUserAddress\">\r\n\t\t\t\t<p>{{ deliveryaddress != null ? deliveryaddress.address : '请选择收货地址' }}</p>\r\n\t\t\t\t<i class=\"fa fa-angle-right\"></i>\r\n\t\t\t</div>\r\n\t\t\t<p>{{ user.userName }}{{ userSex }} {{ user.userId }}</p>\r\n\t\t</div>\r\n\r\n\t\t<h3>{{ business.businessName }}</h3>\r\n\r\n\t\t<!-- 订单明细 -->\r\n\t\t<ul class=\"order-detailed\">\r\n\t\t\t<li v-for=\"item in cartArr\" :key=\"item.id\">\r\n\t\t\t\t<div class=\"order-detailed-left\">\r\n\t\t\t\t\t<img :src=\"item.food.foodImg\">\r\n\t\t\t\t\t<p>{{ item.food.foodName }} x {{ item.quantity }}</p>\r\n\t\t\t\t</div>\r\n\t\t\t\t<p>&#165;3{{ item.food.foodPrice*item.quantity }}</p>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\t\t<div class=\"order-deliveryfee\">\r\n\t\t\t<p>配送费</p>\r\n\t\t\t<p>&#165;{{ business.deliveryPrice }}</p>\r\n\t\t</div>\r\n\r\n\t\t<!-- 订单合计 -->\r\n\t\t<div class=\"total\">\r\n\t\t\t<div class=\"total-left\">&#165;{{ totalPrice }}</div>\r\n\t\t\t<div class=\"total-right\" @click=\"toPayment\">去支付</div>\r\n\t\t</div>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tname: 'Orders',\r\n\t\tdata() {\r\n\t\t\treturn{\r\n\t\t\t\tbusinessId:this.$route.query.businessId,\r\n\t\t\t\tbusiness:{},\r\n\t\t\t\tuser:{},\r\n\t\t\t\tcartArr:[],\r\n\t\t\t\tdeliveryaddress:{}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\tcreated(){\r\n\t\t\tthis.user=this.$getSessionStorage('user');\r\n\t\t\tthis.deliveryaddress=this.$getLocalStorage(this.user.userId);\r\n\r\n\t\t\t//查询当前商家\r\n\t\t\tthis.$axios.post('BusinessController/getBusinessById',this.$qs.stringify({\r\n\t\t\t\tbusinessId:this.businessId\r\n\t\t\t})).then(response=>{\r\n\t\t\t\tthis.business=response.data;\r\n\t\t\t}).catch(error=>{\r\n\t\t\t\tconsole.error(error);\r\n\t\t\t});\r\n\r\n\t\t\t//查询当前用户在购物车中的商家食品列表\r\n\t\t\tthis.$axios.post('CartController/listCart',this.$qs.stringify({\r\n\t\t\t\tuserId:this.user.userId,\r\n\t\t\t\tbusinessId:this.businessId\r\n\t\t\t})).then(response=>{\r\n\t\t\t\tthis.cartArr=response.data;\r\n\t\t\t}).catch(error=>{\r\n\t\t\t\tconsole.error(error);\r\n\t\t\t});\r\n\t\t},\r\n\r\n\t\tmethods: {\r\n\t\t\ttoUserAddress(){\r\n\t\t\t\tthis.$router.push({path:'/userAddress',query:{businessId:this.businessId}});\r\n\t\t\t},\r\n\t\t\ttoPayment() {\r\n\t\t\t\tif(this.deliveryaddress==null){\r\n\t\t\t\t\talert('请选择送货地址');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t//创建订单\r\n\t\t\t\tthis.$axios.post('OrderController/createOrders',this.$qs.stringify({\r\n\t\t\t\t\tuserId:this.user.userId,\r\n\t\t\t\t\tbusinessId:this.businessId,\r\n\t\t\t\t\tdaId:this.deliveryaddress,\r\n\t\t\t\t\torderTotal:this.totalPrice\r\n\t\t\t\t})).then(response=>{\r\n\t\t\t\t\tlet orderId=response.data;\r\n\t\t\t\t\tif(orderId>0){\r\n\t\t\t\t\t\tthis.$router.push({path:'/payment',});\r\n\t\t\t\t\t}else{\r\n\t\t\t\t\t\talter('创建订单失败');\r\n\t\t\t\t\t}\r\n\t\t\t\t}).catch(error=>{\r\n\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t});\r\n\t\t\t\t\t\r\n\t\t\t\t},\r\n\t\t},\r\n\r\n\t\tcomputed:{\r\n\t\t\ttotalPrice(){\r\n\t\t\t\tlet totalPrice=0;\r\n\t\t\t\tfor(let cartItem of this.cartArr){\r\n\t\t\t\t\ttotalPrice+=cartItem.food.foodPrice*cartItem.quantity;\r\n\t\t\t\t}\r\n\t\t\t\ttotalPrice+=this.business.deliveryPrice;\r\n\t\t\t\treturn totalPrice;\r\n\t\t\t},\r\n\t\t\tuserSex() {\r\n\t\t\t\treturn this.user.userSex === 1 ? '先生' : '女士';\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t/****************** 总容器 ****************/\r\n\t.wrapper {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t/****************** header ****************/\r\n\t.wrapper header {\r\n\t\twidth: 100%;\r\n\t\theight: 12vw;\r\n\t\tbackground-color: #0097ff;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 4.8vw;\r\n\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\ttop: 0;\r\n\t\tz-index: 1000;\r\n\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t/****************** 订单信息 ****************/\r\n\t.wrapper .order-info {\r\n\t\twidth: 100%;\r\n\t\tmargin-top: 12vw;\r\n\t\tbackground-color: #0097ef;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 2vw;\r\n\t\tcolor: #fff;\r\n\t}\r\n\r\n\t.wrapper .order-info h5 {\r\n\t\tfont-size: 3vw;\r\n\t\tfont-weight: 300;\r\n\t}\r\n\r\n\t.wrapper .order-info .order-info-address {\r\n\t\twidth: 100%;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\r\n\t\tfont-weight: 700;\r\n\t\tuser-select: none;\r\n\t\tcursor: pointer;\r\n\t\tmargin: 1vw 0;\r\n\t}\r\n\r\n\t.wrapper .order-info .order-info-address p {\r\n\t\twidth: 90%;\r\n\t\tfont-size: 5vw;\r\n\t}\r\n\r\n\t.wrapper .order-info .order-info-address i {\r\n\t\tfont-size: 6vw;\r\n\t}\r\n\r\n\t.wrapper .order-info p {\r\n\t\tfont-size: 3vw;\r\n\t}\r\n\r\n\t.wrapper h3 {\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 3vw;\r\n\t\tfont-size: 4vw;\r\n\t\tcolor: #666;\r\n\t\tborder-bottom: solid 1px #ddd;\r\n\t}\r\n\r\n\t/****************** 订单明细 ****************/\r\n\t.wrapper .order-detailed {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.wrapper .order-detailed li {\r\n\t\twidth: 100%;\r\n\t\theight: 16vw;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 3vw;\r\n\t\tcolor: #666;\r\n\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.wrapper .order-detailed li .order-detailed-left {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.wrapper .order-detailed li .order-detailed-left img {\r\n\t\twidth: 10vw;\r\n\t\theight: 10vw;\r\n\t}\r\n\r\n\t.wrapper .order-detailed li .order-detailed-left p {\r\n\t\tfont-size: 3.5vw;\r\n\t\tmargin-left: 3vw;\r\n\t}\r\n\r\n\t.wrapper .order-detailed li p {\r\n\t\tfont-size: 3.5vw;\r\n\t}\r\n\r\n\t.wrapper .order-deliveryfee {\r\n\t\twidth: 100%;\r\n\t\theight: 16vw;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 3vw;\r\n\t\tcolor: #666;\r\n\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: space-between;\r\n\t\talign-items: center;\r\n\r\n\t\tfont-size: 3.5vw;\r\n\t}\r\n\r\n\t/****************** 订单合计 ****************/\r\n\t.wrapper .total {\r\n\t\twidth: 100%;\r\n\t\theight: 14vw;\r\n\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\tbottom: 0;\r\n\r\n\t\tdisplay: flex;\r\n\t}\r\n\r\n\t.wrapper .total .total-left {\r\n\t\tflex: 2;\r\n\t\tbackground-color: #505051;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 4, 5vw;\r\n\t\tfont-weight: 700;\r\n\t\tuser-select: none;\r\n\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.wrapper .total .total-right {\r\n\t\tflex: 1;\r\n\t\tbackground-color: #38ca73;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 4.5vw;\r\n\t\tfont-weight: 700;\r\n\t\tuser-select: none;\r\n\t\tcursor: pointer;\r\n\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n</style>\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}