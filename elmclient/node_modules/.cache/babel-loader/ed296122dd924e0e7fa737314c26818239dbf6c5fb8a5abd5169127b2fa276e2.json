{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, inject, onMounted, watch, computed, onUnmounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport axios from 'axios';\nimport qs from 'qs';\nimport Footer from '../components/Footer.vue';\nexport default {\n  name: 'Credit',\n  components: {\n    Footer\n  },\n  setup() {\n    const detailArr = ref([]);\n    const user = ref(JSON.parse(sessionStorage.getItem('user')));\n    const isRuleModalVisible = ref(false);\n    const credit = ref(0);\n    const router = useRouter();\n    const toIndex = () => {\n      router.push('/index');\n    };\n    const showRuleModal = () => {\n      isRuleModalVisible.value = true;\n    };\n    const closeRuleModal = () => {\n      isRuleModalVisible.value = false;\n    };\n\n    // 请求总积分\n    let url1 = `http://localhost:10700/IntegrationController/getCreditByUserId/${user.value.userId}`;\n    const getCreditByUserId = () => {\n      axios.get(url1).then(response => {\n        if (response.data.result == '') {\n          credit.value = 0;\n        } else {\n          credit.value = response.data.result;\n        }\n        // console.log('总积分:', credit.value);\n      }).catch(error => {\n        console.error(error);\n      });\n    };\n\n    // 请求积分明细\n    let url2 = `http://localhost:10700/IntegrationController/getDetailsByUserId/${user.value.userId}`;\n    const getDetailsByUserId = () => {\n      axios.post(url2).then(response => {\n        detailArr.value = response.data.result;\n        // console.log('积分信息:', detailArr.value);\n      }).catch(error => {\n        console.error(error);\n      });\n    };\n    onMounted(() => {\n      getCreditByUserId();\n      getDetailsByUserId();\n    });\n    return {\n      detailArr,\n      user,\n      isRuleModalVisible,\n      credit,\n      toIndex,\n      showRuleModal,\n      closeRuleModal\n    };\n  }\n};","map":{"version":3,"names":["ref","inject","onMounted","watch","computed","onUnmounted","useRouter","axios","qs","Footer","name","components","setup","detailArr","user","JSON","parse","sessionStorage","getItem","isRuleModalVisible","credit","router","toIndex","push","showRuleModal","value","closeRuleModal","url1","userId","getCreditByUserId","get","then","response","data","result","catch","error","console","url2","getDetailsByUserId","post"],"sources":["F:\\elmprogram\\elm\\elmclient\\src\\views\\Credit.vue"],"sourcesContent":["<template>\r\n\t<div class=\"wrapper\">\r\n\t\t<!-- header -->\r\n\t\t<header>\r\n\t\t\t<p>我的积分</p>\r\n\t\t</header>\r\n\r\n\t\t<!-- 总积分 -->\r\n\t\t<div class=\"credit\">\r\n\t\t\t<div class=\"credit-icon\"><i class=\"fa fa-gift\"></i></div>\r\n\t\t\t<h2>{{ credit }}</h2>\r\n\t\t\t<p>总积分</p>\r\n\t\t\t<div class=\"credit-use\">\r\n\t\t\t\t<button @click=\"toIndex\">去使用</button>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<!-- 积分明细 -->\r\n\t\t<h3>\r\n\t\t\t积分明细\r\n\t\t\t<span class=\"credit-rule\" @click=\"showRuleModal\">\r\n\t\t\t\t积分规则\r\n\t\t\t\t<i class=\"fa fa-question-circle\"></i>\r\n\t\t\t</span>\r\n\t\t</h3>\r\n\r\n\t\t<!-- 积分明细 -->\r\n\t\t<ul class=\"credit-detailed\">\r\n\t\t\t<ul class=\"credit-detailed\">\r\n\t\t\t\t<li v-for=\"item in detailArr\" :key=\"item.id\">\r\n\t\t\t\t\t<div class=\"credit-detailed-left\" v-if=\"item.points > 0\">\r\n\t\t\t\t\t\t<p>获得积分</p>\r\n\t\t\t\t\t\t<p>{{ item.integrationDate }}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"credit-detailed-left\" v-if=\"item.points < 0 && item.integrationState==1\">\r\n\t\t\t\t\t\t<p>积分过期</p>\r\n\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t<div class=\"credit-detailed-left\" v-if=\"item.points < 0 && item.integrationState==2\">\r\n\t\t\t\t\t\t<p>使用积分</p>\r\n\t\t\t\t\t\t<p>{{ item.integrationDate }}</p>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div class=\"credit-detailed-right\">\r\n\t\t\t\t\t\t<p :style=\"{color: item.points > 0 ? 'green' : 'red'}\"><span v-if=\"item.points > 0\">+</span>{{ item.points }}</p>\r\n\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</li>\r\n\t\t\t</ul>\r\n\t\t</ul>\r\n\r\n\t\t<!-- 底部菜单部分 -->\r\n\t\t<Footer></Footer>\r\n\t</div>\r\n\r\n\t<!-- 使用规则 -->\r\n\t<div v-if=\"isRuleModalVisible\" class=\"rule-modal-overlay\" @click=\"closeRuleModal\">\r\n\t\t<div class=\"rule-modal-content\" @click.stop>\r\n\t\t\t<h4>积分规则</h4>\r\n\t\t\t<p class=\"rule-modal-content-title\">1.积分累计</p>\r\n\t\t\t<p>&nbsp;&nbsp;&nbsp;用户每完成一个订单，将获得与订单总金额相同数量的积分。例如：订单金额为100元，用户将获得100积分。<br></p>\r\n\t\t\t<p class=\"rule-modal-content-title\">2.积分使用</p>\r\n\t\t\t<p>&nbsp;&nbsp;&nbsp;当用户进行支付时，积分可以抵扣订单金额的十分之一数量的钱。例如：若用户拥有1000积分，最多可以抵扣100元。\r\n\t\t\t\t若用户的积分少于订单金额，则该订单不可使用积分抵扣。\r\n\t\t\t\t使用积分抵扣的金额部分不会再获得积分。<br>\r\n\t\t\t\t积分抵扣金额按照四舍五入进行计算。例如：如果金额为24.5元，则使用25的积分，抵扣2.5元。</p>\r\n\t\t\t<p class=\"rule-modal-content-title\">3.积分有效期</p>\r\n\t\t\t<p>&nbsp;&nbsp;&nbsp;获得的积分具有一年的有效期。例如：2023年9月1日获得的积分，将会在2024年9月1日过期。<br></p>\r\n\t\t\t<p class=\"rule-modal-content-title\">4.积分查询</p>\r\n\t\t\t<p>&nbsp;&nbsp;&nbsp;用户可以在“我的” -> “我的积分”中查看剩余积分和积分明细。</p>\r\n\t\t\t<p class=\"rule-modal-content-title\">5.其他</p>\r\n\t\t\t<p>&nbsp;&nbsp;&nbsp;饿了么保留在法律允许范围内更改、暂停或终止此积分规则的权利，用户需定期查看以了解最新规则。</p>\r\n\t\t\t<p class=\"rule-modal-content-bottom\">&nbsp;&nbsp;&nbsp;感谢您选择饿了么，我们将不断努力为您带来更好的服务和更多的优惠！</p>\r\n\t\t</div>\r\n\r\n\t</div>\r\n\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tref,\r\n\t\tinject,\r\n\t\tonMounted,\r\n\t\twatch,\r\n\t\tcomputed,\r\n\t\tonUnmounted\r\n\t} from 'vue';\r\n\timport {\r\n\t\tuseRouter\r\n\t} from 'vue-router';\r\n\timport axios from 'axios';\r\n\timport qs from 'qs';\r\n\timport Footer from '../components/Footer.vue';\r\n\texport default {\r\n\t\tname: 'Credit',\r\n\t\tcomponents: {\r\n\t\t\tFooter\r\n\t\t},\r\n\t\tsetup() {\r\n\t\t\tconst detailArr = ref([]);\r\n\t\t\tconst user = ref(JSON.parse(sessionStorage.getItem('user')));\r\n\t\t\tconst isRuleModalVisible = ref(false);\r\n\t\t\tconst credit = ref(0);\r\n\t\t\tconst router = useRouter();\r\n\r\n\t\t\tconst toIndex = () => {\r\n\t\t\t\trouter.push('/index');\r\n\t\t\t};\r\n\t\t\tconst showRuleModal = () => {\r\n\t\t\t\tisRuleModalVisible.value = true;\r\n\t\t\t};\r\n\t\t\tconst closeRuleModal = () => {\r\n\t\t\t\tisRuleModalVisible.value = false;\r\n\t\t\t};\r\n\r\n\t\t\t// 请求总积分\r\n\t\t\tlet url1 = `http://localhost:10700/IntegrationController/getCreditByUserId/${user.value.userId}`;\r\n\t\t\tconst getCreditByUserId = () => {\r\n\t\t\t\taxios.get(url1)\r\n\t\t\t\t\t.then(response => {\r\n\t\t\t\t\t\tif (response.data.result == '') {\r\n\t\t\t\t\t\t\tcredit.value = 0;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tcredit.value = response.data.result;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t// console.log('总积分:', credit.value);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\t// 请求积分明细\r\n\t\t\tlet url2 = `http://localhost:10700/IntegrationController/getDetailsByUserId/${user.value.userId}`;\r\n\t\t\tconst getDetailsByUserId = () => {\r\n\t\t\t\taxios.post(url2)\r\n\t\t\t\t\t.then(response => {\r\n\t\t\t\t\t\tdetailArr.value = response.data.result;\r\n\t\t\t\t\t\t// console.log('积分信息:', detailArr.value);\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tonMounted(() => {\r\n\t\t\t\tgetCreditByUserId();\r\n\t\t\t\tgetDetailsByUserId();\r\n\t\t\t});\r\n\r\n\r\n\t\t\treturn {\r\n\t\t\t\tdetailArr,\r\n\t\t\t\tuser,\r\n\t\t\t\tisRuleModalVisible,\r\n\t\t\t\tcredit,\r\n\t\t\t\ttoIndex,\r\n\t\t\t\tshowRuleModal,\r\n\t\t\t\tcloseRuleModal\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t/****************** 总容器 ****************/\r\n\t.wrapper {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t\tbackground-color: #F5F4F6;\r\n\t\toverflow: hidden;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tpadding-bottom: 85vw;\r\n\t}\r\n\r\n\t/****************** header ****************/\r\n\t.wrapper header {\r\n\t\twidth: 100%;\r\n\t\theight: 20vw;\r\n\t\tbackground-color: #0097ff;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 4.8vw;\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\ttop: 0;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t/****************** 总积分 ****************/\r\n\t.wrapper .credit {\r\n\t\twidth: 90%;\r\n\t\theight: 80vw;\r\n\t\tmargin: 15vw auto 5vw;\r\n\t\tbackground-color: #fff;\r\n\t\tborder-radius: 2vw;\r\n\t\tbox-sizing: border-box;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tz-index: 2;\r\n\t}\r\n\r\n\t.wrapper .credit-icon {\r\n\t\tmargin: 15vw 10px 10px 10px;\r\n\t}\r\n\r\n\t.wrapper .credit i {\r\n\t\tfont-size: 9vw;\r\n\t\tcolor: mediumpurple\r\n\t}\r\n\r\n\t.wrapper .credit h2 {\r\n\t\tfont-size: 8vw;\r\n\t\tmargin-bottom: 1vw;\r\n\t}\r\n\r\n\t.wrapper .credit p {\r\n\t\tfont-size: 3vw;\r\n\t\tcolor: #777;\r\n\t\tmargin-bottom: 3vw;\r\n\t}\r\n\r\n\t.wrapper .credit .credit-use {\r\n\t\twidth: 100%;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 5vw 10vw 10vw 10vw;\r\n\t}\r\n\r\n\t.wrapper .credit .credit-use button {\r\n\t\twidth: 100%;\r\n\t\theight: 13vw;\r\n\t\tfont-size: 5vw;\r\n\t\tfont-weight: 700;\r\n\t\tcolor: #fff;\r\n\t\tbackground-color: #0097ff;\r\n\t\tborder-radius: 50px;\r\n\t\tborder: none;\r\n\t\toutline: none;\r\n\t}\r\n\r\n\t/****************** 积分明细 ****************/\r\n\t.wrapper .credit-detailed {\r\n\t\twidth: 100%;\r\n\t\tz-index: 2;\r\n\t}\r\n\r\n\t.wrapper .credit-detailed::after {\r\n\t\tcontent: \"\";\r\n\t\tdisplay: block;\r\n\t\theight: 14vw;\r\n\t}\r\n\r\n\t.wrapper h3 {\r\n\t\tmargin-left: 6vw;\r\n\t\tfont-size: 4vw;\r\n\t}\r\n\r\n\t.wrapper .credit-detailed li {\r\n\t\twidth: 90%;\r\n\t\theight: 15vw;\r\n\t\tbackground-color: #fff;\r\n\t\tmargin: 2vw auto;\r\n\t\tborder-radius: 2vw;\r\n\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: space-between;\r\n\t}\r\n\r\n\t.wrapper .credit-detailed li .credit-detailed-left {\r\n\t\tmargin-left: 4vw;\r\n\t}\r\n\r\n\t.wrapper .credit-detailed li .credit-detailed-left p:first-child {\r\n\t\tfont-size: 3.8vw;\r\n\t\tcolor: #111;\r\n\t}\r\n\r\n\t.wrapper .credit-detailed li .credit-detailed-left p:last-child {\r\n\t\tfont-size: 3vw;\r\n\t\tcolor: #777;\r\n\t\tmargin-top: 1vw;\r\n\t}\r\n\r\n\t.wrapper .credit-detailed li .credit-detailed-right {\r\n\t\tmargin-right: 4vw;\r\n\t\tmargin-bottom: 5vw;\r\n\t}\r\n\r\n\t.wrapper .credit-detailed li .credit-detailed-right p {\r\n\t\tfont-size: 3.5vw;\r\n\t\tcolor: red;\r\n\t}\r\n\r\n\t.credit-rule {\r\n\t\tfont-size: 2.6vw;\r\n\t\tmargin-left: 2vw;\r\n\t\tcolor: #5d5f60;\r\n\t\tcursor: pointer;\r\n\t}\r\n\r\n\t/****************** 积分规则弹窗 ****************/\r\n\t.credit-rule i {\r\n\t\tmargin-left: 1vw;\r\n\t\tfont-size: 2vw;\r\n\t\tcolor: grey;\r\n\t}\r\n\r\n\t.rule-modal-overlay {\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\tbackground-color: rgba(0, 0, 0, 0.4);\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tz-index: 1000;\r\n\t}\r\n\r\n\t.rule-modal-content {\r\n\t\tbackground-color: #fff;\r\n\t\tpadding: 4vw;\r\n\t\tborder-radius: 2.5vw;\r\n\t\tbox-shadow: 0 0 10px rgba(0, 0, 0, 0.3);\r\n\t\tmax-width: 85vw;\r\n\t\twidth: 100%;\r\n\t\tposition: relative;\r\n\t\tmax-height: 70vh;\r\n\t\toverflow-y: auto;\r\n\t}\r\n\r\n\r\n\t.rule-modal-content h4 {\r\n\t\tfont-size: 5vw;\r\n\t\tmargin-bottom: 1.5vw;\r\n\t\tfont-weight: 600;\r\n\t\tborder-bottom: 2px solid #dedede;\r\n\t\tpadding-bottom: 1vw;\r\n\t\ttext-align: center;\r\n\t\tcolor: #333;\r\n\t\tfont-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;\r\n\t\tborder-image: linear-gradient(to right, #aaa, #333, #aaa);\r\n\t\tborder-image-slice: 1;\r\n\t}\r\n\r\n\r\n\r\n\t.rule-modal-content p {\r\n\t\tfont-size: 4vw;\r\n\t\tline-height: 5.5vw;\r\n\t\tcolor: #666;\r\n\t\tmargin-bottom: 1.2vw;\r\n\t}\r\n\r\n\r\n\t.rule-modal-content-title {\r\n\t\tfont-size: 4.5vw;\r\n\t\tcolor: black;\r\n\t\tfont-weight: bold;\r\n\t\tmargin-bottom: 1.5vw;\r\n\t}\r\n\r\n\t.rule-modal-content-bottom {\r\n\t\tfont-size: 4.5vw;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: #444;\r\n\t\tmargin-top: 2vw;\r\n\t\tpadding-left: 1.5vw;\r\n\t\tborder-top: 1px solid #dedede;\r\n\t\tpadding-top: 1.5vw;\r\n\t}\r\n</style>\r\n"],"mappings":";AA8EC,SACCA,GAAG,EACHC,MAAM,EACNC,SAAS,EACTC,KAAK,EACLC,QAAQ,EACRC,WAAU,QACJ,KAAK;AACZ,SACCC,SAAQ,QACF,YAAY;AACnB,OAAOC,KAAI,MAAO,OAAO;AACzB,OAAOC,EAAC,MAAO,IAAI;AACnB,OAAOC,MAAK,MAAO,0BAA0B;AAC7C,eAAe;EACdC,IAAI,EAAE,QAAQ;EACdC,UAAU,EAAE;IACXF;EACD,CAAC;EACDG,KAAKA,CAAA,EAAG;IACP,MAAMC,SAAQ,GAAIb,GAAG,CAAC,EAAE,CAAC;IACzB,MAAMc,IAAG,GAAId,GAAG,CAACe,IAAI,CAACC,KAAK,CAACC,cAAc,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;IAC5D,MAAMC,kBAAiB,GAAInB,GAAG,CAAC,KAAK,CAAC;IACrC,MAAMoB,MAAK,GAAIpB,GAAG,CAAC,CAAC,CAAC;IACrB,MAAMqB,MAAK,GAAIf,SAAS,CAAC,CAAC;IAE1B,MAAMgB,OAAM,GAAIA,CAAA,KAAM;MACrBD,MAAM,CAACE,IAAI,CAAC,QAAQ,CAAC;IACtB,CAAC;IACD,MAAMC,aAAY,GAAIA,CAAA,KAAM;MAC3BL,kBAAkB,CAACM,KAAI,GAAI,IAAI;IAChC,CAAC;IACD,MAAMC,cAAa,GAAIA,CAAA,KAAM;MAC5BP,kBAAkB,CAACM,KAAI,GAAI,KAAK;IACjC,CAAC;;IAED;IACA,IAAIE,IAAG,GAAK,kEAAiEb,IAAI,CAACW,KAAK,CAACG,MAAO,EAAC;IAChG,MAAMC,iBAAgB,GAAIA,CAAA,KAAM;MAC/BtB,KAAK,CAACuB,GAAG,CAACH,IAAI,EACZI,IAAI,CAACC,QAAO,IAAK;QACjB,IAAIA,QAAQ,CAACC,IAAI,CAACC,MAAK,IAAK,EAAE,EAAE;UAC/Bd,MAAM,CAACK,KAAI,GAAI,CAAC;QACjB,OAAO;UACNL,MAAM,CAACK,KAAI,GAAIO,QAAQ,CAACC,IAAI,CAACC,MAAM;QACpC;QACA;MACD,CAAC,EACAC,KAAK,CAACC,KAAI,IAAK;QACfC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACrB,CAAC,CAAC;IACJ,CAAC;;IAED;IACA,IAAIE,IAAG,GAAK,mEAAkExB,IAAI,CAACW,KAAK,CAACG,MAAO,EAAC;IACjG,MAAMW,kBAAiB,GAAIA,CAAA,KAAM;MAChChC,KAAK,CAACiC,IAAI,CAACF,IAAI,EACbP,IAAI,CAACC,QAAO,IAAK;QACjBnB,SAAS,CAACY,KAAI,GAAIO,QAAQ,CAACC,IAAI,CAACC,MAAM;QACtC;MACD,CAAC,EACAC,KAAK,CAACC,KAAI,IAAK;QACfC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACrB,CAAC,CAAC;IACJ,CAAC;IAEDlC,SAAS,CAAC,MAAM;MACf2B,iBAAiB,CAAC,CAAC;MACnBU,kBAAkB,CAAC,CAAC;IACrB,CAAC,CAAC;IAGF,OAAO;MACN1B,SAAS;MACTC,IAAI;MACJK,kBAAkB;MAClBC,MAAM;MACNE,OAAO;MACPE,aAAa;MACbE;IACD;EACD;AACD"},"metadata":{},"sourceType":"module","externalDependencies":[]}