{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport { ref, inject, onMounted, watch, computed, onUnmounted } from 'vue';\nimport { useRouter } from 'vue-router';\nimport axios from 'axios';\nimport qs from 'qs';\nimport Footer from '../components/Footer.vue';\nimport { useRoute } from 'vue-router';\nexport default {\n  name: 'BusinessList',\n  components: {\n    Footer\n  },\n  setup() {\n    const route = useRoute(); // Initialize the useRoute hook\n    const router = useRouter();\n    const orderTypeId = ref(route.query.orderTypeId || null);\n    const user = ref(JSON.parse(sessionStorage.getItem('user')));\n    const businessArr = ref([]);\n\n    // 请求购物车信息\n    const listCart = () => {\n      let url = `http://localhost:10400/CartController/listCart/${user.value.userId}`;\n      axios.get(url).then(response => {\n        let cartArr = response.data.result;\n        //遍历所有食品列表\n        for (let businessItem of businessArr.value) {\n          businessItem.quantity = 0;\n          for (let cartItem of cartArr) {\n            if (cartItem.businessId == businessItem.businessId) {\n              businessItem.quantity += cartItem.quantity;\n            }\n          }\n        }\n        businessArr.value.sort();\n      }).catch(error => {\n        console.error(error);\n      });\n    };\n    const toBusinessInfo = businessId => {\n      router.push({\n        path: '/businessInfo',\n        query: {\n          businessId: businessId\n        }\n      });\n    };\n\n    // 请求商家信息\n    const fetchBusinessInfo = () => {\n      let url = `http://localhost:10300/BusinessController/listBusinessByOrderTypeId/${orderTypeId.value}`;\n      axios.get(url).then(response => {\n        businessArr.value = response.data.result;\n        // console.log(businessArr.value);\n\n        if (user.value !== null) {\n          listCart();\n        }\n      }).catch(error => {\n        console.error(error);\n      });\n    };\n    onMounted(() => {\n      fetchBusinessInfo();\n      // console.log(orderTypeId.value);\n    });\n\n    return {\n      orderTypeId,\n      businessArr,\n      user,\n      toBusinessInfo,\n      listCart\n    };\n  }\n};","map":{"version":3,"names":["ref","inject","onMounted","watch","computed","onUnmounted","useRouter","axios","qs","Footer","useRoute","name","components","setup","route","router","orderTypeId","query","user","JSON","parse","sessionStorage","getItem","businessArr","listCart","url","value","userId","get","then","response","cartArr","data","result","businessItem","quantity","cartItem","businessId","sort","catch","error","console","toBusinessInfo","push","path","fetchBusinessInfo"],"sources":["F:\\elmprogram\\elm\\elmclient\\src\\views\\BusinessList.vue"],"sourcesContent":["<template>\r\n\t<div class=\"wrapper\">\r\n\t\t<!-- header -->\r\n\t\t<header>\r\n\t\t\t<p>商家列表</p>\r\n\t\t</header>\r\n\r\n\t\t<!-- 商家列表 -->\r\n\t\t<ul class=\"business\">\r\n\t\t\t<li v-for=\"item in businessArr\" :key=\"item.id\" @click=\"toBusinessInfo(item.businessId)\">\r\n\t\t\t\t<div class=\"business-img\">\r\n\t\t\t\t\t<img :src=\"item.businessImg\">\r\n\t\t\t\t\t<div class=\"business-img-quantity\" v-show=\"item.quantity>0\">{{ item.quantity }}</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"business-info\">\r\n\t\t\t\t\t<h3>{{ item.businessName }}</h3>\r\n\t\t\t\t\t<p>&#165;{{ item.starPrice/100 }}起送 | &#165;{{ item.deliveryPrice/100 }}配送</p>\r\n\t\t\t\t\t<p>{{ item.businessExplain }}</p>\r\n\t\t\t\t</div>\r\n\t\t\t</li>\r\n\t\t</ul>\r\n\r\n\t\t<!-- 底部菜单部分 -->\r\n\t\t<Footer></Footer>\r\n\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tref,\r\n\t\tinject,\r\n\t\tonMounted,\r\n\t\twatch,\r\n\t\tcomputed,\r\n\t\tonUnmounted\r\n\t} from 'vue';\r\n\timport {\r\n\t\tuseRouter\r\n\t} from 'vue-router';\r\n\timport axios from 'axios';\r\n\timport qs from 'qs';\r\n\timport Footer from '../components/Footer.vue';\r\n\timport {\r\n\t\tuseRoute\r\n\t} from 'vue-router';\r\n\texport default {\r\n\t\tname: 'BusinessList',\r\n\t\tcomponents: {\r\n\t\t\tFooter\r\n\t\t},\r\n\t\tsetup() {\r\n\t\t\tconst route = useRoute(); // Initialize the useRoute hook\r\n\t\t\tconst router = useRouter();\r\n\t\t\tconst orderTypeId = ref(route.query.orderTypeId || null);\r\n\t\t\tconst user = ref(JSON.parse(sessionStorage.getItem('user')));\r\n\t\t\tconst businessArr = ref([]);\r\n\r\n\r\n\t\t\t// 请求购物车信息\r\n\t\t\tconst listCart = () => {\r\n\t\t\t\tlet url = `http://localhost:10400/CartController/listCart/${user.value.userId}`;\r\n\t\t\t\taxios.get(url).then(response => {\r\n\t\t\t\t\tlet cartArr = response.data.result;\r\n\t\t\t\t\t//遍历所有食品列表\r\n\t\t\t\t\tfor (let businessItem of businessArr.value) {\r\n\t\t\t\t\t\tbusinessItem.quantity = 0;\r\n\t\t\t\t\t\tfor (let cartItem of cartArr) {\r\n\t\t\t\t\t\t\tif (cartItem.businessId == businessItem.businessId) {\r\n\t\t\t\t\t\t\t\tbusinessItem.quantity += cartItem.quantity;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbusinessArr.value.sort();\r\n\t\t\t\t}).catch(error => {\r\n\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tconst toBusinessInfo = (businessId) => {\r\n\t\t\t\trouter.push({\r\n\t\t\t\t\tpath: '/businessInfo',\r\n\t\t\t\t\tquery: {\r\n\t\t\t\t\t\tbusinessId: businessId\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// 请求商家信息\r\n\t\t\tconst fetchBusinessInfo = () => {\r\n\t\t\t\tlet url = `http://localhost:10300/BusinessController/listBusinessByOrderTypeId/${orderTypeId.value}`;\r\n\t\t\t\taxios.get(url)\r\n\t\t\t\t\t.then(response => {\r\n\t\t\t\t\t\tbusinessArr.value = response.data.result;\r\n\t\t\t\t\t\t// console.log(businessArr.value);\r\n\r\n\t\t\t\t\t\tif (user.value !== null) {\r\n\t\t\t\t\t\t\tlistCart();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.catch(error => {\r\n\t\t\t\t\t\tconsole.error(error);\r\n\t\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tonMounted(() => {\r\n\t\t\t\tfetchBusinessInfo();\r\n\t\t\t\t// console.log(orderTypeId.value);\r\n\t\t\t});\r\n\r\n\t\t\treturn {\r\n\t\t\t\torderTypeId,\r\n\t\t\t\tbusinessArr,\r\n\t\t\t\tuser,\r\n\t\t\t\ttoBusinessInfo,\r\n\t\t\t\tlistCart\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style scoped>\r\n\t/****************** 总容器 ****************/\r\n\t.wrapper {\r\n\t\twidth: 100%;\r\n\t\theight: 100%;\r\n\t}\r\n\r\n\t/****************** header ****************/\r\n\t.wrapper header {\r\n\t\twidth: 100%;\r\n\t\theight: 12vw;\r\n\t\tbackground-color: #0097ff;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 4.8vw;\r\n\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\ttop: 0;\r\n\t\tz-index: 1000;\r\n\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t/****************** 商家列表 ****************/\r\n\t.wrapper .business {\r\n\t\twidth: 100%;\r\n\t\tmargin-top: 12vw;\r\n\t}\r\n\r\n\t.wrapper .business::after {\r\n\t\tcontent: \"\";\r\n\t\tdisplay: block;\r\n\t\theight: 14vw;\r\n\t}\r\n\r\n\t.wrapper .business li {\r\n\t\twidth: 100%;\r\n\t\tbox-sizing: border-box;\r\n\t\tpadding: 2.5vw;\r\n\t\tborder-bottom: solid 1px #ddd;\r\n\t\tuser-select: none;\r\n\t\tcursor: pointer;\r\n\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t}\r\n\r\n\t.wrapper .business li .business-img {\r\n\t\tposition: relative;\r\n\r\n\t}\r\n\r\n\t.wrapper .business li .business-img img {\r\n\t\twidth: 20vw;\r\n\t\theight: 20vw;\r\n\t}\r\n\r\n\t.wrapper .business li .business-img .business-img-quantity {\r\n\t\twidth: 5vw;\r\n\t\theight: 5vw;\r\n\t\tbackground-color: red;\r\n\t\tcolor: #fff;\r\n\t\tfont-size: 3, 6vw;\r\n\t\tborder-radius: 2.5vw;\r\n\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\r\n\t\tposition: absolute;\r\n\t\tright: -1.5vw;\r\n\t\ttop: -1.5vw;\r\n\t}\r\n\r\n\t.wrapper .business li .business-info {\r\n\t\tmargin-left: 3vw;\r\n\t}\r\n\r\n\t.wrapper .business li .business-info h3 {\r\n\t\tfont-size: 3.8vw;\r\n\t\tcolor: #555;\r\n\t}\r\n\r\n\t.wrapper .business li .business-info p {\r\n\t\tfont-size: 3vw;\r\n\t\tcolor: #888;\r\n\t\tmargin-top: 2vw;\r\n\t}\r\n</style>\r\n"],"mappings":";AA6BC,SACCA,GAAG,EACHC,MAAM,EACNC,SAAS,EACTC,KAAK,EACLC,QAAQ,EACRC,WAAU,QACJ,KAAK;AACZ,SACCC,SAAQ,QACF,YAAY;AACnB,OAAOC,KAAI,MAAO,OAAO;AACzB,OAAOC,EAAC,MAAO,IAAI;AACnB,OAAOC,MAAK,MAAO,0BAA0B;AAC7C,SACCC,QAAO,QACD,YAAY;AACnB,eAAe;EACdC,IAAI,EAAE,cAAc;EACpBC,UAAU,EAAE;IACXH;EACD,CAAC;EACDI,KAAKA,CAAA,EAAG;IACP,MAAMC,KAAI,GAAIJ,QAAQ,CAAC,CAAC,EAAE;IAC1B,MAAMK,MAAK,GAAIT,SAAS,CAAC,CAAC;IAC1B,MAAMU,WAAU,GAAIhB,GAAG,CAACc,KAAK,CAACG,KAAK,CAACD,WAAU,IAAK,IAAI,CAAC;IACxD,MAAME,IAAG,GAAIlB,GAAG,CAACmB,IAAI,CAACC,KAAK,CAACC,cAAc,CAACC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;IAC5D,MAAMC,WAAU,GAAIvB,GAAG,CAAC,EAAE,CAAC;;IAG3B;IACA,MAAMwB,QAAO,GAAIA,CAAA,KAAM;MACtB,IAAIC,GAAE,GAAK,kDAAiDP,IAAI,CAACQ,KAAK,CAACC,MAAO,EAAC;MAC/EpB,KAAK,CAACqB,GAAG,CAACH,GAAG,CAAC,CAACI,IAAI,CAACC,QAAO,IAAK;QAC/B,IAAIC,OAAM,GAAID,QAAQ,CAACE,IAAI,CAACC,MAAM;QAClC;QACA,KAAK,IAAIC,YAAW,IAAKX,WAAW,CAACG,KAAK,EAAE;UAC3CQ,YAAY,CAACC,QAAO,GAAI,CAAC;UACzB,KAAK,IAAIC,QAAO,IAAKL,OAAO,EAAE;YAC7B,IAAIK,QAAQ,CAACC,UAAS,IAAKH,YAAY,CAACG,UAAU,EAAE;cACnDH,YAAY,CAACC,QAAO,IAAKC,QAAQ,CAACD,QAAQ;YAC3C;UACD;QACD;QACAZ,WAAW,CAACG,KAAK,CAACY,IAAI,CAAC,CAAC;MACzB,CAAC,CAAC,CAACC,KAAK,CAACC,KAAI,IAAK;QACjBC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACrB,CAAC,CAAC;IACH,CAAC;IAED,MAAME,cAAa,GAAKL,UAAU,IAAK;MACtCtB,MAAM,CAAC4B,IAAI,CAAC;QACXC,IAAI,EAAE,eAAe;QACrB3B,KAAK,EAAE;UACNoB,UAAU,EAAEA;QACb;MACD,CAAC,CAAC;IACH;;IAEA;IACA,MAAMQ,iBAAgB,GAAIA,CAAA,KAAM;MAC/B,IAAIpB,GAAE,GAAK,uEAAsET,WAAW,CAACU,KAAM,EAAC;MACpGnB,KAAK,CAACqB,GAAG,CAACH,GAAG,EACXI,IAAI,CAACC,QAAO,IAAK;QACjBP,WAAW,CAACG,KAAI,GAAII,QAAQ,CAACE,IAAI,CAACC,MAAM;QACxC;;QAEA,IAAIf,IAAI,CAACQ,KAAI,KAAM,IAAI,EAAE;UACxBF,QAAQ,CAAC,CAAC;QACX;MACD,CAAC,EACAe,KAAK,CAACC,KAAI,IAAK;QACfC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACrB,CAAC,CAAC;IACJ,CAAC;IAEDtC,SAAS,CAAC,MAAM;MACf2C,iBAAiB,CAAC,CAAC;MACnB;IACD,CAAC,CAAC;;IAEF,OAAO;MACN7B,WAAW;MACXO,WAAW;MACXL,IAAI;MACJwB,cAAc;MACdlB;IACD;EACD;AACD"},"metadata":{},"sourceType":"module","externalDependencies":[]}